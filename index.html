<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>RiverVill PD - OSINT System</title>
    <style>
        :root {
            --win-gray: #c0c0c0;
            --win-dark: #808080;
            --win-blue: #000080;
            --term-green: #33ff33;
        }

        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; font-family: 'Courier New', monospace; overflow: hidden; }

        /* CRT –û–í–ï–†–õ–ï–ô */
        .crt-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%),
                        linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            z-index: 9999; background-size: 100% 3px, 3px 100%; pointer-events: none; opacity: 0.5;
        }

        /* –≠–ö–†–ê–ù –í–´–ë–û–†–ê */
        #boot-screen {
            position: fixed; width: 100%; height: 100%; background: #000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 5000; color: var(--term-green);
        }
        .boot-box { border: 2px solid var(--term-green); padding: 40px; background: #050505; text-align: center; }
        .boot-btn { background: transparent; color: var(--term-green); border: 1px solid var(--term-green); padding: 10px 20px; margin: 10px; cursor: pointer; font-family: inherit; }
        .boot-btn:hover { background: var(--term-green); color: #000; }

        /* –ò–ù–¢–ï–†–§–ï–ô–° –û–° */
        #os-interface { display: none; height: 100%; flex-direction: column; }
        #top-bar { background: var(--win-gray); border-bottom: 2px solid var(--win-dark); color: #000; padding: 5px 15px; display: flex; justify-content: space-between; font-size: 12px; font-weight: bold; }
        #desktop { flex-grow: 1; background: #3a6ea5; position: relative; }
        
        /* –ò–ö–û–ù–ö–ò */
        .desktop-icon {
            width: 80px; margin: 20px; text-align: center; color: white; cursor: pointer;
            text-shadow: 1px 1px 2px black; font-size: 12px;
        }
        .icon-pic { font-size: 40px; margin-bottom: 5px; display: block; }

        /* –û–ö–ù–ê */
        .window { position: absolute; background: var(--win-gray); border: 2px solid #fff; border-right: 2px solid var(--win-dark); border-bottom: 2px solid var(--win-dark); display: none; flex-direction: column; z-index: 100; }
        .title-bar { background: var(--win-blue); color: white; padding: 4px 8px; display: flex; justify-content: space-between; font-size: 12px; }
        .content { padding: 15px; color: black; background: white; margin: 2px; border: 1px solid var(--win-dark); overflow-y: auto; white-space: pre-wrap; font-size: 14px; line-height: 1.4; }

        /* 2D –†–ï–ñ–ò–ú */
        #room-view { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 4000; }
        canvas { display: block; }
        .ui-hint { position: absolute; bottom: 20px; width: 100%; text-align: center; color: white; pointer-events: none; text-shadow: 2px 2px #000; }
    </style>
</head>
<body>

<div class="crt-overlay"></div>

<div id="boot-screen">
    <div class="boot-box">
        <h1>RIVERVILL PD - OSINT SESSION</h1>
        <p>–í–´–ë–ï–†–ò–¢–ï –Ø–ó–´–ö / SELECT LANGUAGE</p>
        <button class="boot-btn" onclick="initGame('ru')">–†–£–°–°–ö–ò–ô</button>
        <button class="boot-btn" onclick="initGame('en')">ENGLISH</button>
        <p>–°–õ–û–ñ–ù–û–°–¢–¨ / DIFFICULTY</p>
        <button class="boot-btn" onclick="setDiff('Story')">STORY MODE</button>
        <button class="boot-btn" onclick="setDiff('Novice')">–ù–û–í–ò–ß–ï–ö</button>
    </div>
</div>

<div id="os-interface">
    <div id="top-bar">
        <div>RiverVill Police Department - OSINT v1.7</div>
        <div id="status-text">User 1 Conor | üåßÔ∏è –î–æ–∂–¥—å, 12¬∞C</div>
    </div>
    <div id="desktop">
        <div style="display: flex; flex-direction: column;">
            <div class="desktop-icon" onclick="openWin('mail-win')">
                <span class="icon-pic">üì¨</span><span>–ü–æ—á—Ç–∞</span>
            </div>
            <div class="desktop-icon" onclick="openWin('archive-win')">
                <span class="icon-pic">üóÑÔ∏è</span><span>–ê—Ä—Ö–∏–≤</span>
            </div>
        </div>
        
        <button onclick="enterRoom()" style="position: absolute; bottom: 20px; right: 20px; padding: 10px; cursor: pointer;">–í–°–¢–ê–¢–¨ (STAND UP)</button>

        <div id="mail-win" class="window" style="width: 550px; left: 100px; top: 50px;">
            <div class="title-bar"><span>Inbox - Secure Mail</span><button onclick="closeWin('mail-win')">X</button></div>
            <div class="content" style="height: 350px;">
                <div style="border-bottom: 1px solid #888; padding-bottom: 10px; margin-bottom: 10px;">
                    <strong>–û—Ç:</strong> –ö–æ–º–∞–Ω–¥–∏—Ä<br>
                    <strong>–¢–µ–º–∞:</strong> –í–í–û–î–ù–´–ô –ò–ù–°–¢–†–£–ö–¢–ê–ñ
                </div>
                <div id="mail-text"></div>
                <hr>
                <div style="color: red;">
                    <strong>[–ù–û–í–û–ï –°–û–û–ë–©–ï–ù–ò–ï –û–¢: –õ–∏–∑–∞]</strong><br>
                    <span id="lisa-mail-text"></span>
                </div>
            </div>
        </div>

        <div id="archive-win" class="window" style="width: 500px; left: 150px; top: 100px;">
            <div class="title-bar"><span>RiverVill Archive - Case Files</span><button onclick="closeWin('archive-win')">X</button></div>
            <div class="content" style="height: 300px;">
                <div style="background: #eee; padding: 5px; border: 1px solid #999; margin-bottom: 10px;">
                    üìÑ <strong>Lisa's case.doc</strong>
                </div>
                <div id="archive-text"></div>
            </div>
        </div>
    </div>
</div>

<div id="room-view">
    <canvas id="gameCanvas"></canvas>
    <div class="ui-hint">[WASD] - –•–æ–¥–∏—Ç—å | [E] - –í–µ—Ä–Ω—É—Ç—å—Å—è –∑–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä</div>
</div>

<script>
    let lang = 'ru';
    let difficulty = 'Novice';

    // –¢–í–û–ò –û–†–ò–ì–ò–ù–ê–õ–¨–ù–´–ï –¢–ï–ö–°–¢–´
    const database = {
        ru: {
            mail_cmd: "–ó–¥—Ä–∞—Å—Ç–≤—É–π –Ω–æ–≤–∏—á–µ–∫, –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π —Ç—ã –≤–∏–¥–µ—à—å —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª –≤–µ—Ä–Ω–æ ? –ï—Å–ª–∏ –≤ –∫—Ä–∞—Ç—Ü–µ –∫–∞–∫ –∏ –ø–æ–ª–æ–≥–∞–µ—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–∏—Ä—É —è –æ–±—å—è—Å–Ω—é —Ç–≤–æ—é –∑–∞–¥–∞—á—É –∏ –∫–µ–π—Å –∫–æ—Ç–æ—Ä—ã–π —Ç—ã –¥–æ–ª–∂–µ–Ω —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, —Ç–≤–æ—è —Ü–µ–ª—å —ç—Ç–æ —Ä–∞—Å—É–∑–Ω–∞—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –æ –Ω–∞—à–µ–π –∂–µ—Ä—Ç–≤–µ –∏–ª–∏ –∂–µ –≤—Ä–∞–≥–µ –∏ –≤ –∏—Ç–æ–≥–µ –µ–≥–æ –Ω–∞–π—Ç–∏.... –ø–æ–∫–∞ –æ–Ω –Ω–µ –Ω–∞—à–µ–ª —Ç–µ–±—è (—Ö–∞—Ö–∞) –Ω–æ –µ—Å–ª–∏ —Ç–µ–±—è –Ω–µ –ø—É–≥–∞—Ç—å —Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–∞–≤–¥–∞ –º–æ–∂–µ—Ç —Å–ª—É—á–∏—Ç—å—Å—è... –í–æ–æ–±—â–µ–º –µ—Å–ª–∏ –±—É–¥—É—Ç –ø–æ—Å—Ç—É–ø–∞—Ç—å –Ω–æ–≤—ã–µ —É–∫–∞–∑–∞–Ω–∏—è –∏–ª–∏ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã —Ç–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ç—ã –∏—Ö —Å–º–æ–∂–µ—à—å –∑–¥–µ—Å—å... —É —Ç–µ–±—è –µ—â—ë —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ—è–≤–∏—Ç—å—Å—è... –¥–æ –≤—Å—Ç—Ä–µ—á –¥–æ—Ä–æ–π –∞–≥–µ–Ω—Ç –ö–æ–Ω–æ—Ä",
            mail_lisa: "–ó–¥—Ä–∞—Å—Ç–≤—É–π—Ç–µ —è –æ–±—Ä–∞—â–∞—é—Å—å –∫ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—É –ø–æ–ª–∏—Ü–∏–∏ —Ç–∞–∫ –∫–∞–∫ —Ö–æ—á—É —Å–æ–æ–±—â–∏—Ç—å —á—Ç–æ –º–æ—è –ª–∞–±–æ—Ä–æ—Ç–æ—Ä–∏—è –∫–æ—Ç–æ—Ä—É—é —è –ø–æ—Å–µ—â–∞—é –º–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –Ω–µ–ª–µ–≥–∞–ª—å—â–∏–Ω–æ–π.... –ø—Ä–æ—à—É –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –º–æ–π –∑–∞–ø—Ä–æ—Å, –ø–æ–º–æ–≥–∏—Ç–µ ! (–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –º–µ—Å—è—Ü –Ω–∞–∑–∞–¥ –≤ 23:45)",
            archive_lisa: "–ó–¥—Ä–∞—Å—Ç–≤—É–π—Ç–µ –∞–≥–µ–Ω—Ç –ö–æ–Ω–æ—Ä ! –ú—ã —Ö–æ—Ç–∏–º –≤–∞—Å –≤–≤–µ—Å—Ç–∏ –≤ –∫—É—Ä—Å –¥–µ–ª–∞... –í–∞—à–∞ —Ü–µ–ª—å —ç—Ç–æ –õ–∏–∑–∞ –°–∏–Ω, –µ–π 24 –≥–æ–¥–∞ —Ä–∞–Ω–µ–µ –ø—Ä–æ–∂–∏–≤–∞–ª–∞ –≤ –æ–∫—Ä—É–≥–∞—Ö –•–∞–≤–∞–µ–≤, –æ–Ω–∞ –ø—Ä–æ—Ö–æ–¥–∏–ª–∞ —Ç–µ—Å—Ç—ã –≤ –ª–∞–±–æ—Ä–æ—Ç–æ—Ä–∏–∏ X-Network –ø–æ—Å–ª–µ —á–µ–≥–æ –±–µ—Å—Å–ª–µ–¥–Ω–æ –ø—Ä–æ–ø–∞–ª–∞... —Ö–æ–¥—è—Ç —Å–ª—É—Ö–∏ —á—Ç–æ –æ–Ω–∞ –∂–∏–≤–∞ –∏ –∑–∞–±–∏—Ä–∞–µ—Ç —á—É–∂–∏–µ –∂–∏–∑–Ω–∏... –±—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–µ–Ω –∫–æ–Ω–æ—Ä, –ª–∞–¥—ã?",
            weather: "User 1 Conor | üåßÔ∏è –î–æ–∂–¥—å, 12¬∞C"
        },
        en: {
            mail_cmd: "Hello rookie, you see the desktop in front of you, right? Briefly, as a commander should, I'll explain your task... find out as much as possible about our victim or enemy... before they find you (haha). Check here for directives. See you, Agent Conor.",
            mail_lisa: "Hello, I am contacting the police department... the lab I visit may be doing illegal things. HELP ME! (Sent 1 month ago at 23:45)",
            archive_lisa: "Hello Agent Conor! Target: Lisa Sin, 24, Hawaii. Vanished after X-Network tests. Rumors say she's alive and taking lives. Be careful, Conor, okay?",
            weather: "User 1 Conor | üåßÔ∏è Rain, 12¬∞C"
        }
    };

    function setDiff(d) { difficulty = d; }

    function initGame(l) {
        lang = l;
        document.getElementById('boot-screen').style.display = 'none';
        document.getElementById('os-interface').style.display = 'flex';
        document.getElementById('mail-text').innerText = database[lang].mail_cmd;
        document.getElementById('lisa-mail-text').innerText = database[lang].mail_lisa;
        document.getElementById('archive-text').innerText = database[lang].archive_lisa;
        document.getElementById('status-text').innerText = database[lang].weather;
    }

    function openWin(id) { document.getElementById(id).style.display = 'flex'; }
    function closeWin(id) { document.getElementById(id).style.display = 'none'; }

    // --- 2D –î–í–ò–ñ–û–ö ---
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    let player = { x: 500, y: 500, w: 40, h: 40, speed: 6, frame: 0 };
    let keys = {};

    window.onkeydown = (e) => { 
        keys[e.key.toLowerCase()] = true; 
        if(e.key.toLowerCase() === 'e' || e.key.toLowerCase() === '—É') {
            if(player.y > 450) exitRoom();
        }
    };
    window.onkeyup = (e) => { keys[e.key.toLowerCase()] = false; };

    function enterRoom() {
        document.getElementById('os-interface').style.display = 'none';
        document.getElementById('room-view').style.display = 'block';
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        requestAnimationFrame(gameLoop);
    }

    function exitRoom() {
        document.getElementById('room-view').style.display = 'none';
        document.getElementById('os-interface').style.display = 'flex';
    }

    function gameLoop() {
        if(document.getElementById('room-view').style.display === 'none') return;
        update();
        draw();
        requestAnimationFrame(gameLoop);
    }

    function update() {
        if(keys['w'] || keys['—Ü']) player.y -= player.speed;
        if(keys['s'] || keys['—ã']) player.y += player.speed;
        if(keys['a'] || keys['—Ñ']) player.x -= player.speed;
        if(keys['d'] || keys['–≤']) player.x += player.speed;
        player.frame += 0.05;
        // –ö–æ–ª–ª–∏–∑–∏–∏
        player.x = Math.max(50, Math.min(canvas.width-90, player.x));
        player.y = Math.max(150, Math.min(canvas.height-90, player.y));
    }

    function draw() {
        // –ü–æ–ª –∏ –°—Ç–µ–Ω—ã
        ctx.fillStyle = "#111"; ctx.fillRect(0,0,canvas.width, canvas.height);
        ctx.fillStyle = "#050505"; ctx.fillRect(0,0,canvas.width, 150);
        
        // –û–∫–Ω–æ —Å –¥–æ–∂–¥–µ–º
        ctx.fillStyle = "#001a33"; ctx.fillRect(canvas.width/2 - 100, 40, 200, 80);
        ctx.strokeStyle = "rgba(255,255,255,0.4)";
        for(let i=0; i<10; i++) {
            let dx = (canvas.width/2-100) + ((Math.sin(i+player.frame)+1)*100);
            let dy = 40 + (player.frame*60 + i*20)%80;
            ctx.beginPath(); ctx.moveTo(dx, dy); ctx.lineTo(dx-2, dy+8); ctx.stroke();
        }

        // –ö–∞–±–∏–Ω–∫–∏ –æ—Ñ–∏—Å–∞
        for(let i=0; i<2; i++) {
            ctx.fillStyle = "#333"; ctx.fillRect(100 + i*600, 250, 150, 80);
            ctx.fillStyle = "#222"; ctx.fillRect(100 + i*600, 240, 150, 10);
            ctx.fillStyle = "#4b3621"; ctx.fillRect(120+i*600, 260, 30, 30); // NPC
        }

        // –¢–í–û–ô –°–¢–û–õ
        ctx.fillStyle = "#444"; ctx.fillRect(canvas.width/2 - 80, 520, 160, 80);
        ctx.fillStyle = "#33ff33"; ctx.shadowBlur = 10; ctx.shadowColor = "#33ff33";
        ctx.fillRect(canvas.width/2 - 40, 515, 80, 5); ctx.shadowBlur = 0;

        // –ö–û–ù–û–†
        let breath = Math.sin(player.frame*2)*2;
        ctx.fillStyle = "#d2b48c"; ctx.fillRect(player.x, player.y+breath, 40, 40);
        ctx.fillStyle = "#3e2723"; ctx.fillRect(player.x, player.y+25+breath, 40, 15);
        ctx.fillStyle = "black"; 
        ctx.fillRect(player.x+8, player.y+12+breath, 10, 2);
        ctx.fillRect(player.x+22, player.y+12+breath, 10, 2);
    }
</script>
</body>
</html>
