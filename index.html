<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>RiverVill PD - Terminal 2.6</title>
    <style>
        :root {
            --win-gray: #c0c0c0;
            --win-dark: #808080;
            --win-blue: #000080;
            --term-green: #33ff33;
            --rage-red: #ff3333;
        }

        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; font-family: 'Courier New', monospace; overflow: hidden; }

        .crt-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%),
                        linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            z-index: 9999; background-size: 100% 3px, 3px 100%; pointer-events: none; opacity: 0.4;
        }

        @keyframes shake {
            0% { transform: translate(1px, 1px); }
            20% { transform: translate(-1px, -2px); }
            40% { transform: translate(-3px, 0px); }
            60% { transform: translate(3px, 2px); }
            80% { transform: translate(1px, -1px); }
            100% { transform: translate(-1px, 2px); }
        }
        .rage-text { color: var(--rage-red) !important; display: inline-block; animation: shake 0.2s infinite; font-weight: bold; }

        /* –ò–ù–¢–ï–†–§–ï–ô–° –û–° */
        #boot-screen { position: fixed; width: 100%; height: 100%; background: #050505; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 5000; color: var(--term-green); }
        .boot-box { border: 2px solid var(--term-green); padding: 40px; background: #000; text-align: center; }
        .boot-btn { background: transparent; color: var(--term-green); border: 1px solid var(--term-green); padding: 10px 25px; margin: 10px; cursor: pointer; transition: 0.2s; font-family: inherit; }
        .boot-btn.selected { background: var(--term-green); color: #000; }
        #start-btn { margin-top: 30px; display: none; border-width: 3px; }

        #os-interface { display: none; height: 100%; flex-direction: column; }
        #top-bar { background: var(--win-gray); border-bottom: 2px solid var(--win-dark); color: #000; padding: 5px 15px; display: flex; justify-content: space-between; font-size: 12px; font-weight: bold; }
        #desktop { flex-grow: 1; background: #3a6ea5; position: relative; }
        
        .desktop-icon { width: 80px; margin: 20px; text-align: center; color: white; cursor: pointer; text-shadow: 1px 1px 2px black; font-size: 12px; }
        .icon-pic { font-size: 40px; margin-bottom: 5px; display: block; }

        .window { position: absolute; background: var(--win-gray); border: 2px solid #fff; border-right: 2px solid var(--win-dark); border-bottom: 2px solid var(--win-dark); display: none; flex-direction: column; z-index: 100; }
        .title-bar { background: var(--win-blue); color: white; padding: 4px 8px; display: flex; justify-content: space-between; font-size: 12px; }
        .close-btn { background: var(--win-gray); border: 1px solid #000; cursor: pointer; font-size: 9px; padding: 0 4px; }
        .content { padding: 15px; color: black; background: white; margin: 2px; border: 1px solid var(--win-dark); overflow-y: auto; white-space: pre-wrap; font-size: 14px; }

        /* –î–ò–ê–õ–û–ì–û–í–û–ï –û–ö–ù–û */
        #dialog-box {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 70%; min-height: 100px; background: rgba(0, 0, 0, 0.95);
            border: 2px solid var(--win-dark); border-top: 4px solid var(--win-blue);
            color: #fff; padding: 20px; display: none; z-index: 4500;
        }
        .dialog-ok { position: absolute; bottom: 10px; right: 10px; background: var(--win-gray); border: 1px solid #fff; color: #000; cursor: pointer; padding: 2px 10px; font-size: 12px; font-weight: bold; }

        #room-view { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 4000; }
        canvas { display: block; }
    </style>
</head>
<body>

<div class="crt-overlay"></div>

<div id="boot-screen">
    <div class="boot-box">
        <h1>RIVERVILL SYSTEM v2.6</h1>
        <p>–Ø–ó–´–ö / LANGUAGE</p>
        <button class="boot-btn" id="lang-ru" onclick="selectLang('ru')">–†–£–°–°–ö–ò–ô</button>
        <button class="boot-btn" id="lang-en" onclick="selectLang('en')">ENGLISH</button>
        <p>–†–ï–ñ–ò–ú –ü–†–ò–°–£–¢–°–¢–í–ò–Ø</p>
        <button class="boot-btn" id="diff-novice" onclick="selectDiff('Novice')">–ù–û–í–ò–ß–ï–ö</button>
        <button class="boot-btn" id="diff-story" onclick="selectDiff('Story')">STORY MODE</button>
        <br>
        <button class="boot-btn" id="start-btn" onclick="startGame()">–í–û–ô–¢–ò –í –ü–£–°–¢–û–¢–£</button>
    </div>
</div>

<div id="os-interface">
    <div id="top-bar">
        <div>RVPD Terminal | User: Conor</div>
        <div id="status-text">12¬∞C | üåßÔ∏è –°–Ω–∞—Ä—É–∂–∏ –≤—Å—ë —Å–ø–æ–∫–æ–π–Ω–æ...</div>
    </div>
    <div id="desktop">
        <div style="display: flex; flex-direction: column;">
            <div class="desktop-icon" onclick="openWin('mail-win')"><span class="icon-pic">üì¨</span><span>–ü–æ—á—Ç–∞</span></div>
            <div class="desktop-icon" onclick="openWin('archive-win')"><span class="icon-pic">üóÑÔ∏è</span><span>–ê—Ä—Ö–∏–≤</span></div>
        </div>
        <button onclick="enterRoom()" style="position: absolute; bottom: 20px; right: 20px; padding: 10px; cursor: pointer;">–í–°–¢–ê–¢–¨ (STAND UP)</button>

        <div id="mail-win" class="window" style="width: 550px; left: 100px; top: 50px;">
            <div class="title-bar"><span>Mail_Client</span><button class="close-btn" onclick="closeWin('mail-win', true)">X</button></div>
            <div class="content" style="height: 380px;" id="mail-body"></div>
        </div>

        <div id="archive-win" class="window" style="width: 500px; left: 150px; top: 100px;">
            <div class="title-bar"><span>Archive_#049</span><button class="close-btn" onclick="closeWin('archive-win')">X</button></div>
            <div id="archive-body" class="content" style="height: 380px;"></div>
        </div>
    </div>
    
    <div id="dialog-box">
        <div id="dialog-name" style="color:var(--term-green); font-weight:bold; margin-bottom:10px;">–ö–û–ù–û–†:</div>
        <div id="dialog-text"></div>
        <button class="dialog-ok" onclick="hideDialog()">–ó–ê–ö–†–´–¢–¨ [X]</button>
    </div>
</div>

<div id="room-view">
    <canvas id="gameCanvas"></canvas>
</div>

<script>
    let currentLang = null;
    let currentDiff = null;
    let mailOpened = false;

    const data = {
        ru: {
            cmd: "–ó–¥–æ—Ä–æ–≤–æ, –ö–æ–Ω–æ—Ä. –†–∞–∑–≥—Ä–µ–±–∞–π —ç—Ç–æ –¥–µ—Ä—å–º–æ —Å –õ–∏–∑–æ–π –°–∏–Ω. –í—Å–µ–º –Ω–∞–≤–µ—Ä—Ö—É –ø–ª–µ–≤–∞—Ç—å, –æ–Ω–∏ —Ö–æ—Ç—è—Ç —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã. –ü—Ä–æ—Å—Ç–æ –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –Ω–µ —Å–¥–æ—Ö–Ω—É—Ç—å, –ª–∞–¥–Ω–æ? –ê —Ç–æ –æ—Ç—á–µ—Ç—ã –ø–∏—Å–∞—Ç—å –±—É–¥–µ—Ç –Ω–µ–∫–æ–º—É.",
            lisa_mail: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞... X-Network... –æ–Ω–∏ –≥—Ä–µ–±–∞–Ω—ã–µ –º—è—Å–Ω–∏–∫–∏. –Ø –Ω–µ —Ö–æ—á—É –ø—Ä–æ—Å—Ç–æ –∏—Å—á–µ–∑–Ω—É—Ç—å.",
            case: "–û–ë–™–ï–ö–¢: –õ–∏–∑–∞ –°–∏–Ω. –ü—Ä–æ–ø–∞–ª–∞ –±–µ–∑ –≤–µ—Å—Ç–∏. –í—Å–µ–º –ø–æ—Ö—Ä–µ–Ω. –ö–æ–Ω–æ—Ä, —Ç–µ–±—è –∫–∏–Ω—É–ª–∏ –Ω–∞ —ç—Ç–æ –¥–µ–ª–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç—ã –Ω–æ–≤–µ–Ω—å–∫–∏–π.",
            start_msg: "–ò —Ç–∞–∫... –ø–æ—Ä–∞ –∑–∞–Ω—è—Ç—å—Å—è —ç—Ç–∏–º... –¥–µ–ª–æ–º? –ù–∞–¥–µ—é—Å—å, —á—Ç–æ –≤—Å—ë –±—É–¥–µ—Ç –≤ –ø–æ—Ä—è–¥–∫–µ...",
            rage_msg: "–í–æ—Ç –∂–µ —Å—É–∫–∞... –¢–æ –µ—Å—Ç—å –æ–Ω–∏ –º–µ–Ω—è <span class='rage-text'>–ù–ê –°–ú–ï–†–¢–¨</span> —Å —ç—Ç–æ–π –õ–∏–∑–æ–π –ø–æ—Å—ã–ª–∞—é—Ç?! –ù–µ–µ, –Ω—É —Ç–∞–∫ –Ω–µ –ø–æ–π–¥—ë—Ç... –Ø —ç—Ç–æ –¥–µ–ª–æ —Ä–∞–∑–≥—Ä–µ–±—É –∏ —ç—Ç—É <span class='rage-text'>–ß–ï–†–¢–û–í–£ –í–ï–†–•–£–®–ö–£ –†–ê–°–•–£–Ø–ß–£!</span>"
        },
        en: {
            cmd: "Hey Conor. Deal with this Lisa Sin crap. High-ups don't care. Just try not to die, okay?",
            lisa_mail: "Please... X-Network... they are butchers. I don't want to vanish.",
            case: "SUBJECT: Lisa Sin. Missing. Nobody gives a shit. Conor, they threw you this because you're new.",
            start_msg: "Well... time to get to this... case? Hope everything will be fine...",
            rage_msg: "Son of a bitch... So they're sending me to <span class='rage-text'>MY DEATH</span> with this Lisa?! No way... I'll solve this and <span class='rage-text'>FUCK UP THAT DAMN LEADERSHIP!</span>"
        }
    };

    function selectLang(l) {
        currentLang = l;
        document.querySelectorAll('.boot-btn[id^="lang-"]').forEach(b => b.classList.remove('selected'));
        document.getElementById('lang-' + l).classList.add('selected');
        checkStart();
    }

    function selectDiff(d) {
        currentDiff = d;
        document.querySelectorAll('.boot-btn[id^="diff-"]').forEach(b => b.classList.remove('selected'));
        document.getElementById('diff-' + d.toLowerCase()).classList.add('selected');
        checkStart();
    }

    function checkStart() { if(currentLang && currentDiff) document.getElementById('start-btn').style.display = 'inline-block'; }

    function showDialog(text) {
        const box = document.getElementById('dialog-box');
        const textElem = document.getElementById('dialog-text');
        box.style.display = 'block';
        textElem.innerHTML = text;
    }

    function hideDialog() {
        document.getElementById('dialog-box').style.display = 'none';
    }

    function startGame() {
        document.getElementById('boot-screen').style.display = 'none';
        document.getElementById('os-interface').style.display = 'flex';
        document.getElementById('mail-body').innerHTML = `<strong>–û–¢: –ö–æ–º–∞–Ω–¥–∏—Ä</strong><br>${data[currentLang].cmd}<hr><strong style="color:red">–û–¢: –õ–∏–∑–∞ –°–∏–Ω</strong><br>${data[currentLang].lisa_mail}`;
        document.getElementById('archive-body').innerHTML = `<strong>CASE_REPORT_#049</strong><br><br>${data[currentLang].case}`;
        
        setTimeout(() => { showDialog(data[currentLang].start_msg); }, 1000);
    }

    function openWin(id) { 
        document.getElementById(id).style.display = 'flex'; 
        if(id === 'mail-win') mailOpened = true;
    }

    function closeWin(id, checkRage = false) { 
        document.getElementById(id).style.display = 'none'; 
        if(checkRage && mailOpened) {
            setTimeout(() => { showDialog(data[currentLang].rage_msg); }, 3000);
            mailOpened = false; 
        }
    }

    // --- 2D ENGINE (STABLE) ---
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    let player = { x: 400, y: 500, speed: 6, frame: 0 };
    let keys = {};

    window.onkeydown = (e) => { 
        keys[e.key.toLowerCase()] = true; 
        if((e.key === 'e' || e.key === '—É') && player.y > 450) enterRoom(); 
    };
    window.onkeyup = (e) => keys[e.key.toLowerCase()] = false;

    function enterRoom() {
        document.getElementById('os-interface').style.display = 'none';
        document.getElementById('room-view').style.display = 'block';
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        requestAnimationFrame(gameLoop);
    }
    function exitRoom() { document.getElementById('room-view').style.display = 'none'; document.getElementById('os-interface').style.display = 'flex'; }

    function gameLoop() {
        if(document.getElementById('room-view').style.display === 'none') return;
        if(keys['w'] || keys['—Ü']) player.y -= player.speed;
        if(keys['s'] || keys['—ã']) player.y += player.speed;
        if(keys['a'] || keys['—Ñ']) player.x -= player.speed;
        if(keys['d'] || keys['–≤']) player.x += player.speed;
        player.frame += 0.05;

        ctx.fillStyle = "#0a0a0a"; ctx.fillRect(0,0,canvas.width, canvas.height);
        ctx.fillStyle = "#333"; ctx.fillRect(canvas.width/2 - 80, 520, 160, 80);
        ctx.fillStyle = "#33ff33"; ctx.fillRect(canvas.width/2 - 40, 515, 80, 5);

        let breath = Math.sin(player.frame*2)*2;
        ctx.fillStyle = "#d2b48c"; ctx.fillRect(player.x, player.y+breath, 40, 40);
        ctx.fillStyle = "#3e2723"; ctx.fillRect(player.x, player.y+25+breath, 40, 15);
        ctx.fillStyle = "black"; ctx.fillRect(player.x+8, player.y+12+breath, 10, 2); ctx.fillRect(player.x+22, player.y+12+breath, 10, 2);
        
        requestAnimationFrame(gameLoop);
    }
</script>
</body>
</html>
